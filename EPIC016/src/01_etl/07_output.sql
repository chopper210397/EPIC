--PARAMETRO DE CREDENCIALES
@&1

ALTER SESSION DISABLE PARALLEL QUERY;

SET ECHO OFF
SET FEEDBACK OFF
SET HEAD OFF
SET LIN 256
SET TRIMSPOOL ON
SET WRAP OFF
SET PAGES 0
SET TERM OFF

SPOOL '.\data\production\01_raw.csv';

PROMPT NUMPERIODO|CODCLAVECIC|TIPPER_AGRUP|MTO_INGRESOS|MTO_EGRESOS|RATIO_ING_TOT|POR_CASH|FLG_PERFIL_3DESVT_TRX|FLG_AN|FLG_LSB_NP;

SELECT
	NUMPERIODO||'|'||
	CODCLAVECIC||'|'||
	TIPPER_AGRUP||'|'||
	REPLACE(TRIM(TO_CHAR(MTO_INGRESOS,'99999999999999999990D00')),',','.')||'|'||
	REPLACE(TRIM(TO_CHAR(MTO_EGRESOS,'99999999999999999990D00')),',','.')||'|'||
	REPLACE(TRIM(TO_CHAR(RATIO_ING_TOT,'99999999999999999990D00')),',','.')||'|'||
	REPLACE(TRIM(TO_CHAR(POR_CASH,'99999999999999999990D00')),',','.')||'|'||
	FLG_PERFIL_3DESVT_TRX||'|'||
	FLG_AN||'|'||
	FLG_LSB_NP
FROM TMP_CONOCMCDO_VAR9;

SPOOL OFF;

QUIT;